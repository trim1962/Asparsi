\chapter{Fibonacci generalizzato}
\section{Definizione}
\begin{defn}[Numeri di Fibonacci generalizzati]\index{Fibonacci!generalizzati!definizione}
	\begin{align}
		\Gib{0}={}&h\notag\\
		\Gib{1}={}&k\notag\\
		\Gib{n}={}&\Gib{n-1}+\Gib{n-2}\quad n>2\label{eqn:FiboGendef}
	\end{align}
\end{defn}
\section{Formula di Binet generalizzata}
\begin{thm}[Formula di Binet generalizzata]\index{Formula!Binet!generalizzata}
Se $\Gib{0}={}h$ e $\Gib{1}={}k$ allora \begin{equation}
	\Gib{n}={}\dfrac{k-bh}{a(a-b)}a^n+\dfrac{ah-k}{b(a-b)}b^n
\end{equation}\label{eqn:FormulaBinetgeneralizzata}
\end{thm}
\begin{proof}
Poniamo che \begin{equation}
	\Gib{n}=xa^n+yb^n
\end{equation} Se
\begin{equation*}
	\left\{
	\begin{array}{l}
		a^0x+b^0y=h\\ a^1x+b^1y=k
	\end{array}
	\right.
\end{equation*}
che risolto porta
\begin{equation*}
	\left\{
	\begin{array}{l}
		x=\dfrac{k-bh}{a-b}\\y=\dfrac{ah-k}{a-b}\\
	\end{array}
	\right.
\end{equation*}
Riassumendo
 \begin{equation*}
	\Gib{n}={}\dfrac{k-bh}{a-b}a^n+\dfrac{ah-k}{a-b}b^n
\end{equation*}
Da cui la tesi.
\end{proof}
\begin{commento}
	Se $\Gib{0}={}2h$ e $\Gib{1}={}2k$ allora \begin{equation}
		\Gib{n}={}2\dfrac{k-bh}{a-b}a^n+2\dfrac{k-ah}{a-b}b^n
	\end{equation}
La somma di due pari è sempre pari quindi la successione è $PPPPPP$
\end{commento}
\begin{commento}
	Se $\Gib{0}={}2h$ e $\Gib{1}={}2k+1$ allora \begin{equation}
		\Gib{n}={}\dfrac{1+2k-2bh}{a-b}a^n+\dfrac{2ah-2k-1}{a-b }b^n
	\end{equation}
La somma è fra un numero pari e un dispari è dispari. Segue la somma tra due dispari che è pari e quello che segue è un dispari. La successione che otteniamo  è $PDDPDDP$
\end{commento}
\begin{commento}
	Se $\Gib{1}={}2h+1$ e $\Gib{2}={}2k$ allora \begin{equation}
		\Gib{n}={}\dfrac{2k-b(2h+1)}{a-b}a^n+\dfrac{a(2h+1)-2k}{a-b}b^n
	\end{equation}
La somma è tra un numero dispari e un pari. In questo caso otteniamo $DPDDPDDP$
\end{commento}
\begin{commento}
	Se $\Gib{0}={}2h+1$ e $\Gib{1}={}2k+1$ allora \begin{equation}
		\Gib{n}={}\dfrac{2k-b(2h+1)}{a-b}a^n-\dfrac{a(2h+1)-2k-1}{a-b}b^n
	\end{equation}
\end{commento}
\begin{commento}
	Se $\Gib{0}={}h$ e $\Gib{1}={}h$ allora \begin{equation}
		\Gib{n}={}h\dfrac{a}{a-b}a^n-h\dfrac{b}{a-b}b^n
	\end{equation}
\end{commento}
\begin{table}
	\centering
	\begin{tabular}{ccc}
\toprule
$h$&$k$&\\
\midrule
	$P$& $P$ &$PPPPPPPPP$ \\
	$P$& $D$ &$PDDPPDDPD$  \\
	$D$& $P$ &$DPDDPDDPD$  \\
	$D$& $D$ &$DDPDDPDDP$  \\
\bottomrule
\end{tabular}
	\caption{Sequenze pari e dispari}
\end{table}
\section{Proprietà}
Possiamo con qualche calcolo, verificare che
\begin{align*}
\Gib{1}={}&h\\
\Gib{2}={}&k\\
\Gib{3}={}&k+h=\Fib{2}k+h\Fib{1}\\
\Gib{4}={}&2k+h=\Fib{3}k+h\Fib{2}\\
\Gib{5}={}&3k+2h=\Fib{4}k+h\Fib{3}\\
\Gib{6}={}&5k+3h=\Fib{5}k+h\Fib{4}
\end{align*} 
\begin{thm}[Derivazione]
	Se $\Gib{n}$ è una successione di Fibonacci generalizzata  con $\Gib{1}=h$ e $\Gib{2}=k $ allora
	\begin{equation}
		\Gib{n}=k\Fib{n-1}+h\Fib{n-2}\quad n>3
	\end{equation}\label{thm:FibGenDer}
	Dove $\Fib{n}$ è la successione di Fibonacci
\end{thm}
\begin{proof}
Per induzione
\begin{align*}
\intertext{proviamola per n+1}
		\Gib{n+1}={}&\Gib{n}+\Gib{n-1}\\
\intertext{per ipotesi induttiva}
\Gib{n}={}&h\Fib{n}+k\Fib{n-1}\\
\Gib{n-1}={}&h\Fib{n-1}+k\Fib{n-2}\\
\Gib{n}+\Gib{n-1}={}&h\Fib{n}+k\Fib{n-1}+h\Fib{n-1}+k\Fib{n-2}\\
={}&h(\Fib{n}+\Fib{n-1})+k(\Fib{n-1}+\Fib{n-2})\\
={}&h\Fib{n+1}+k\Fib{n}\\
\end{align*}
cvd.
\end{proof}
\begin{thm}[Limite successione]
	Se $\Gib{n}$ è la successione di Fibonacci generalizzata allora 
	\begin{equation}
		\lim_{n\to\infty}\dfrac{\Gib{n+1}}{\Gib{n}}=\varphi
	\end{equation}\label{eqn:FibLimRapGen}
\end{thm}
\begin{proof}
	\begin{align*}
		\lim_{n\to\infty}\dfrac{\Gib{n+1}}{\Gib{n}}={}&ab\lim_{n\to\infty}\dfrac{a^n(bh-k)+b^n(k-ah)}{ba^n(bh-k)+ab^n(k-ah)}\\
		={}&ab\lim_{n\to\infty}\dfrac{a^n[(bh-k)+\dfrac{b^n}{a^n}(k-ah)]}{a^n[b(bh-k)+a\dfrac{b^n}{a^n}(k-ah)]}\\
		\intertext{ma}
	\lim_{n\to\infty}\left(\dfrac{b}{a}\right)^n={}&0\\
={}&ab\lim_{n\to\infty}\dfrac{bh-k}{b(bh-k)}\\
={}&ab\dfrac{1}{b}=a=\varphi\\
	\end{align*}
 \end{proof}
\begin{thm}[Quadrato]\label{thm:fibQuadratoGen}
	Se $\Gib{n}$ è la successione di Fibonacci generalizzata allora 
	\begin{equation}
		\Gib{n-1}\cdot\Gib{n+1}=\Gib{n}^2+(-1)^n(k-bh)(ah-k)
	\end{equation}\label{eqn:FibQuadratoGen}
\end{thm}
\begin{proof}
\begin{align*}
	\Gib{n-1}\cdot\Gib{n+1}-\Gib{n}^2={}&
	\dfrac{[ba^n(bh-k)+ab^n(k-ah)][a^{n+1}(bh-k)+b^{n+1}(k-ah)]}{ab(a-b)^2}-\dfrac{[a^n(bh-k)+b^n(k-ah)]^2}{(a-b)^2}\\
	={}&a^{n-1}b^{n-1}(k-bh)(ah-k)
	\intertext{per~\vref{lem:FibpropPhi}}
	={}&\dfrac{(ab)^{n-1}}{ab}(k-bh)(ah-k)\\
	={}&(-1)^{n}(k-bh)(ah-k)
\end{align*}
\end{proof}
\section{Proprietà esclusive successione di Fibonacci}
\begin{thm}[Sistema caratteristico]\label{thm:FibSistCaratteristico}
Se $\Gib{n}$ è una generica successione di Fibonacci con
\[\begin{cases}
\Gib{0}=h\\
\Gib{1}=k\\
\end{cases}\] il sistema 
\begin{equation*}
	\left\{
\begin{array}{l}
	(a^2+1)(k-bh)(k-bh-1)=0\\
	(b^2+1)(ah-k)(ah-k+1)=0
\end{array}
\right.
\end{equation*}
ha come soluzione intera solo \[\begin{cases}
	h=0\\
	k=1\\
\end{cases}\]
\end{thm}
\begin{proof}
Questo sistema ammette quattro soluzioni che sono
\begin{enumerate}
	\item $\left\{
	\begin{array}{l}
		h=0\\
		k=0
	\end{array}
	\right.$
	\item $\left\{
	\begin{array}{l}
		h=0\\
		k=1
	\end{array}
	\right.$
	\item $\left\{
	\begin{array}{l}
		h=\dfrac{1}{a-b}\\
		k=\dfrac{a}{a-b}
	\end{array}
	\right.$
	\item $\left\{
	\begin{array}{l}
		h=-\dfrac{1}{a-b}\\
		k=-\dfrac{b}{a-b}
	\end{array}
	\right.$
\end{enumerate}
Discutiamo le soluzioni. La prima non è accettabile. La seconda sono i valori iniziali della successione di Fibonacci.
La terza e la quarta non sono accettabili perché non intere. 
\end{proof}
\begin{thm}[Dispari]\label{thm:FibdispariGen}
	Se $\Gib{n}$ è la successione di Fibonacci generalizzata e vale 
	\begin{equation}
		\Gib{n}^2+\Gib{n+1}^2-\Gib{2n+1}=0 
	\end{equation}\label{eqn:FibDispariGen} allora 
\[\begin{cases}
	h=0\\
	k=1\\
\end{cases}\]
\end{thm}
\begin{proof}
\begin{align*}
\Gib{n}^2+\Gib{n+1}^2-\Gib{2n+1}={}&a^{2n}\dfrac{(a^2+1)(bh-k)(bh-k+1)}{\left(a-b\right)^2}\\
+&b^{2n}\dfrac{(b^2+1)(ah-k)(ah-k+1)}{\left(a-b\right)^2}\\
\intertext{l'uguaglianza precedente vale zero se $h$ e $k$ sono soluzioni del sistema seguente }
&	\left\{
\begin{array}{l}
	(a^2+1)(k-bh)(k-bh-1)=0\\
	(b^2+1)(ah-k)(ah-k+1)=0
\end{array}
\right.\\
\end{align*}
Quindi per~\vref{thm:FibSistCaratteristico} è la successione di Fibonacci ordinaria.
\end{proof}
Utilizzando il~\vref{thm:FibdispariGen} e il~\vref{thm:Fibdispari} otteniamo
\begin{thm}[Unicità]
	\begin{equation}
		\Gib{n}^2+\Gib{n+1}^2=\Gib{2n+1} 
	\end{equation} se e solo la successione è quella ordinaria di Fibonacci. 
\end{thm}